---
import { fetchBannerData } from '~/lib/fetchBanner'

const banner = await fetchBannerData()
const isEnabled = banner?.isEnabled

const type = banner?.type || 'info'
const content = banner?.content
const addLink = banner?.addLink
const link = banner?.link

const bgColors = {
	info: 'bg-primary',
	warning: 'bg-accent',
	error: 'bg-destructive',
	success: 'bg-primary',
}

const textColors = {
	info: 'text-primary-foreground',
	warning: 'text-accent-foreground',
	error: 'text-destructive-foreground',
	success: 'text-primary-foreground',
}
---

{
	isEnabled && (
		<div class={`${bgColors[type]} ${textColors[type]} px-4 py-3 relative`}>
			<div class="container mx-auto flex items-center justify-between">
				<div class="flex-1 text-center text-sm font-medium flex justify-center items-center">
					<span class="flex items-center" set:html={content}></span>
					{addLink && link && (
						<>
							<span class="mx-2 mr-1 text-muted-foreground">â€”</span>
							<a
								href={
									link.type === 'custom'
										? link.url
										: link.reference?.value?.slug
											? `/${link.reference.value.slug}`
											: '#'
								}
								target={link.newTab ? '_blank' : undefined}
								rel={link.newTab ? 'noopener noreferrer' : undefined}
								class="ml-2 hover:text-opacity-80 transition-colors flex items-center gap-1"
							>
								{link.label || 'Learn more'}
								<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5h6v6m0-6L5 19"/></svg>
							</a>
						</>
					)}
				</div>
			</div>
		</div>
	)
}
