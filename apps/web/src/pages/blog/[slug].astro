---
import MarketingLayout from '../../layouts/MarketingLayout.astro'
import { cmsClient } from '../../lib/cms'
import PostContent from '../../components/PostContent.astro'

const { title, content, meta, publishedAt, categories, heroImage } = Astro.props

export const prerender = true;
// Use cmsClient but follow guide patterns for getStaticPaths
export async function getStaticPaths() {
	const posts = await cmsClient.getPosts(1, 100) // Get all posts for static generation

	return posts.docs.map((post) => {
		console.log(post)
		return {
			params: { slug: post.slug },
			props: {
				title: post.title,
				content: post.content,
				meta: post.meta,
				publishedAt: post.publishedAt,
				categories: post.categories,
				heroImage: post.heroImage,
			},
		}
	})
}
---

<MarketingLayout>
	<PostContent 
		title={title}
		content={content}
		meta={meta}
		publishedAt={publishedAt}
		categories={categories}
		heroImage={heroImage}
	/>
</MarketingLayout>
